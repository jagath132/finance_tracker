import{r as d}from"./vendor-CeoOk9QE.js";import{u as p,s as i}from"./index-Da4dX3Ws.js";import{z as o}from"./ui-_IaUIWm1.js";const w=()=>{const{user:t}=p(),[u,c]=d.useState([]),[y,n]=d.useState(!0),l=d.useCallback(async()=>{if(t){n(!0);try{const{data:e,error:r}=await i.from("categories").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(r){console.error("Error fetching categories:",r),o.error("Failed to load categories");return}c(e||[])}catch(e){console.error("Error fetching categories:",e),o.error("Failed to load categories")}finally{n(!1)}}},[t]);return d.useEffect(()=>{l()},[l]),{categories:u,loading:y,addCategory:async e=>{if(t)try{const{data:r,error:a}=await i.from("categories").insert({...e,user_id:t.id}).select().single();if(a){console.error("Error adding category:",a),o.error("Failed to add category");return}c(s=>[r,...s]),o.success("Category added!")}catch(r){console.error("Error adding category:",r),o.error("Failed to add category")}},updateCategory:async(e,r)=>{try{const{data:a,error:s}=await i.from("categories").update(r).eq("id",e).eq("user_id",t?.id).select().single();if(s){console.error("Error updating category:",s),o.error("Failed to update category");return}c(f=>f.map(g=>g.id===e?a:g)),o.success("Category updated!")}catch(a){console.error("Error updating category:",a),o.error("Failed to update category")}},deleteCategory:async e=>{try{const{error:r}=await i.from("categories").delete().eq("id",e).eq("user_id",t?.id);if(r){console.error("Error deleting category:",r),o.error("Failed to delete category");return}c(a=>a.filter(s=>s.id!==e)),o.success("Category deleted!")}catch(r){console.error("Error deleting category:",r),o.error("Failed to delete category")}},deleteAllCategories:async()=>{if(t)try{const{error:e}=await i.from("categories").delete().eq("user_id",t.id);if(e){console.error("Error deleting all categories:",e),o.error("Failed to delete all categories");return}c([])}catch(e){console.error("Error deleting all categories:",e),o.error("Failed to delete all categories")}},refetch:l}};export{w as u};
