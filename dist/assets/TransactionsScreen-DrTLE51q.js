import{j as e,h as p,m as x,V as D,W as I,q as L,r as _,X as S,R as E,o as z,l as w,u as C,Y as A,k as P,Z as $,w as R,_ as F,p as M,d as U,a as O,n as q,$ as Y}from"./ui-BvQeeWjB.js";import{r as T,f as k,e as G,L as V}from"./vendor-C2v42iKu.js";import{T as W}from"./TransactionListItem-BGPB0cxD.js";import{u as X}from"./useTransactions-ByQLS2az.js";import{u as Z}from"./useCategories-Cn9gT5pe.js";import{a as B}from"./index-z9EIHczJ.js";import"./ConfirmationModal-B2cJ41LW.js";import"./Button-RIE1BFT8.js";const H=({isOpen:b,onClose:d,transaction:r,category:c,onEdit:m,onDelete:y})=>{const[o,l]=T.useState({details:!0,notes:!1,attachments:!1}),[n,i]=T.useState(!1),[h,j]=T.useState(r);if(!r)return null;const u=()=>{window.print()},g=t=>{l(a=>({...a,[t]:!a[t]}))},f=()=>{i(!1)},N=()=>{j(r),i(!1)};return e.jsx(p,{children:b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center print:hidden p-4",onClick:d,children:e.jsxs(x.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-2xl bg-light-primary dark:bg-dark-primary rounded-2xl shadow-2xl max-h-[90vh] flex flex-col overflow-hidden print:max-w-none print:w-full print:max-h-none print:bg-white print:shadow-none print:rounded-none print:m-0 print:p-6",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-light-border dark:border-dark-border bg-gradient-to-r from-brand-green/5 to-brand-green/10 dark:from-brand-green/10 dark:to-brand-green/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white dark:bg-dark-secondary rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("img",{src:"/favicon.svg",alt:"Cointrail Logo",className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-light-text dark:text-dark-text",children:"Cointrail"}),e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Professional Finance Tracker"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:u,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-dark-secondary/50 transition-colors",title:"Print Invoice",children:e.jsx(D,{size:20,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),m&&e.jsx("button",{onClick:()=>i(!n),className:`p-2 rounded-lg transition-colors ${n?"bg-brand-green text-white":"hover:bg-white/50 dark:hover:bg-dark-secondary/50 text-light-text-secondary dark:text-dark-text-secondary"}`,title:n?"Save Changes":"Edit Transaction",children:n?e.jsx(I,{size:20}):e.jsx(L,{size:20})}),y&&e.jsx("button",{onClick:y,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete Transaction",children:e.jsx(_,{size:20,className:"text-red-500"})}),e.jsx("button",{onClick:d,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-dark-secondary/50 transition-colors",children:e.jsx(S,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})})]})]})}),e.jsxs("div",{className:"flex-grow overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{className:"text-brand-green",size:24}),e.jsx("h2",{className:"text-xl font-semibold text-light-text dark:text-dark-text",children:"Transaction Invoice"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Invoice #"}),e.jsx("p",{className:"font-mono text-lg font-semibold",children:r.id.slice(-8)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Date"}),e.jsx("p",{className:"font-medium",children:new Date(r.transaction_date).toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Time"}),e.jsx("p",{className:"font-medium",children:new Date(r.transaction_date).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})})]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg cursor-pointer hover:bg-light-primary dark:hover:bg-dark-primary transition-colors",onClick:()=>g("details"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"text-brand-green",size:20}),e.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text",children:"Transaction Details"})]}),o.details?e.jsx(w,{size:20}):e.jsx(C,{size:20})]}),e.jsx(p,{children:o.details&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Description"}),n?e.jsx("input",{type:"text",value:h?.description||"",onChange:t=>j(a=>a?{...a,description:t.target.value}:null),className:"w-full p-3 border border-light-border dark:border-dark-border rounded-lg bg-light-primary dark:bg-dark-primary focus:ring-2 focus:ring-brand-green focus:border-transparent"}):e.jsx("p",{className:"p-3 bg-light-primary dark:bg-dark-primary rounded-lg font-medium",children:r.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Amount"}),e.jsxs("div",{className:`p-3 rounded-lg font-bold text-xl ${r.type==="income"?"bg-green-50 dark:bg-green-900/20 text-brand-green":"bg-red-50 dark:bg-red-900/20 text-brand-red"}`,children:[r.type==="income"?"+":"-","â‚¹",new Intl.NumberFormat("en-IN").format(r.amount)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Category"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-light-primary dark:bg-dark-primary rounded-lg",children:[c?.icon&&k.createElement(A[c.icon.charAt(0).toUpperCase()+c.icon.slice(1)]||P,{size:20,className:"text-brand-green"}),e.jsx("span",{className:"font-medium",children:c?.name||"Uncategorized"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Type"}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.type==="income"?"bg-green-100 dark:bg-green-900/30 text-brand-green":"bg-red-100 dark:bg-red-900/30 text-brand-red"}`,children:e.jsx("span",{className:"capitalize",children:r.type})})]})]})]})})})]}),r.notes&&e.jsxs("div",{className:"p-6 border-t border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg cursor-pointer hover:bg-light-primary dark:hover:bg-dark-primary transition-colors",onClick:()=>g("notes"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"text-brand-green",size:20}),e.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text",children:"Notes"})]}),o.notes?e.jsx(w,{size:20}):e.jsx(C,{size:20})]}),e.jsx(p,{children:o.notes&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"mt-4 p-4 bg-light-primary dark:bg-dark-primary rounded-lg",children:e.jsx("p",{className:"text-light-text dark:text-dark-text whitespace-pre-wrap",children:r.notes})})})})]}),r.attachment_url&&e.jsxs("div",{className:"p-6 border-t border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg cursor-pointer hover:bg-light-primary dark:hover:bg-dark-primary transition-colors",onClick:()=>g("attachments"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{className:"text-brand-green",size:20}),e.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text",children:"Attachments"})]}),o.attachments?e.jsx(w,{size:20}):e.jsx(C,{size:20})]}),e.jsx(p,{children:o.attachments&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"mt-4 p-4 bg-light-primary dark:bg-dark-primary rounded-lg",children:/\.(jpg|jpeg|png|gif|webp)$/i.test(r.attachment_url)?e.jsx("img",{src:r.attachment_url,alt:"Attachment",className:"max-w-full h-auto rounded-lg shadow-md",loading:"lazy"}):e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg",children:[e.jsx(R,{className:"text-brand-green",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-light-text dark:text-dark-text",children:"Download File"}),e.jsx("a",{href:r.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"text-brand-green hover:underline text-sm",children:"Click to download"})]})]})})})})]}),n&&e.jsx("div",{className:"p-6 border-t border-light-border dark:border-dark-border bg-light-secondary dark:bg-dark-secondary",children:e.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 text-light-text-secondary dark:text-dark-text-secondary hover:bg-light-primary dark:hover:bg-dark-primary rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:f,className:"px-4 py-2 bg-brand-green text-white rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-2",children:[e.jsx(F,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})}),e.jsx("div",{className:"p-6 border-t border-light-border dark:border-dark-border bg-gradient-to-r from-brand-green/5 to-brand-green/10 dark:from-brand-green/10 dark:to-brand-green/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary mb-2",children:"Thank you for using Cointrail!"}),e.jsxs("p",{className:"text-xs text-light-text-secondary dark:text-dark-text-secondary",children:["Generated on ",new Date().toLocaleDateString("en-IN")]})]})})]})]})})})},ne=()=>{const b=G(),{transactions:d,loading:r,deleteTransaction:c}=X(),{categories:m,loading:y}=Z(),{openModal:o}=B(),[l,n]=k.useState(null),[i,h]=k.useState(""),j=t=>m.find(a=>a.id===t)?.name||"Uncategorized",u=t=>m.find(a=>a.id===t)||null,g=()=>{window.scrollTo({top:0,behavior:"smooth"})},f=r||y,N=k.useMemo(()=>{const t=d.filter(s=>s.description.toLowerCase().includes(i.toLowerCase())||j(s.category_id).toLowerCase().includes(i.toLowerCase())),a={};for(const s of t){const v=new Date(s.transaction_date).toDateString();a[v]||(a[v]=[]),a[v].push(s)}return a},[d,i,m]);return e.jsxs("div",{className:"min-h-screen p-4 sm:p-6",children:[e.jsxs("header",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>b("/dashboard"),className:"p-2 rounded-full bg-light-secondary dark:bg-dark-secondary",children:e.jsx(M,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Transactions"}),e.jsx("div",{className:"w-8"})," "]}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:18}),e.jsx("input",{type:"text",placeholder:"Search transactions...",value:i,onChange:t=>h(t.target.value),className:"w-full pl-10 pr-10 py-3 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none"}),i&&e.jsx("button",{onClick:()=>h(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(S,{size:18})})]})]}),f?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(O,{className:"animate-spin text-brand-green",size:32})}):d.length>0?e.jsx(p,{children:e.jsx(x.div,{className:"space-y-4 sm:space-y-6",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05,delayChildren:.1}}},children:Object.entries(N).map(([t,a])=>e.jsxs(x.div,{layout:!0,variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},exit:{opacity:0,y:-10},transition:{duration:.2,ease:"easeOut"},children:[e.jsxs("div",{className:"flex items-center mb-2 sm:mb-3",children:[e.jsx(q,{size:16,className:"text-light-text-secondary dark:text-dark-text-secondary mr-2"}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-light-text dark:text-dark-text",children:new Date(t).toLocaleDateString("en-IN",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]}),e.jsx("div",{className:"space-y-2",children:a.map(s=>e.jsx(W,{transaction:s,category:u(s.category_id),onDelete:()=>c(s.id),onEdit:()=>n(s.id),onClick:()=>b(`/transactions/${s.id}`)},s.id))})]},t))})}):i?e.jsxs("div",{className:"text-center py-20",children:[e.jsxs("p",{className:"text-light-text-secondary dark:text-dark-text-secondary mb-4",children:['No transactions found for "',i,'"']}),e.jsx("button",{onClick:()=>h(""),className:"text-brand-green hover:underline",children:"Clear search"})]}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary mb-4",children:"You have no transactions."}),e.jsx(V,{to:"/add-transaction",className:"bg-brand-green text-white font-bold py-3 px-6 rounded-xl text-lg hover:bg-green-600 transition-colors",children:"Add Transaction"})]}),e.jsx("button",{onClick:g,className:"fixed bottom-20 right-4 p-3 rounded-full bg-brand-green hover:bg-green-600 text-white shadow-lg transition-colors z-50",children:e.jsx(Y,{size:24})}),e.jsx(H,{isOpen:!!l,onClose:()=>n(null),transaction:d.find(t=>t.id===l)||null,category:u(d.find(t=>t.id===l)?.category_id||""),onEdit:()=>{const t=d.find(a=>a.id===l);t&&o("editTransaction",t),n(null)},onDelete:()=>{const t=d.find(a=>a.id===l);t&&c(t.id),n(null)}},l)]})};export{ne as default};
