import{j as e,m as C,h as A,X as I,i as P,k as q,l as _,n as F,o as L,z as f}from"./ui-_IaUIWm1.js";import{r as a}from"./vendor-CeoOk9QE.js";import{B as $}from"./Button-BYbGGxhE.js";import{u as B}from"./useTransactions-BwkPODxv.js";import{u as O}from"./useCategories-nji49Pe3.js";import"./index-Ita0Wmma.js";const R=({option1:c,option2:n,selected:r,setSelected:d})=>{const s=r==="expense";return e.jsxs("div",{className:"relative flex items-center w-64 p-1 bg-dark-secondary rounded-full",children:[e.jsx(C.div,{className:"absolute h-10 w-1/2 rounded-full",layout:!0,transition:{type:"spring",stiffness:300,damping:30},style:{left:s?"2px":"50%",backgroundColor:s?"#EF4444":"#22C55E"}}),e.jsx("button",{type:"button",onClick:()=>d("expense"),className:`relative z-10 w-1/2 py-2 text-sm font-bold rounded-full transition-colors ${s?"text-white":"text-gray-400"}`,children:c}),e.jsx("button",{type:"button",onClick:()=>d("income"),className:`relative z-10 w-1/2 py-2 text-sm font-bold rounded-full transition-colors ${s?"text-gray-400":"text-white"}`,children:n})]})},M=({isOpen:c,onClose:n,transaction:r})=>{const{addTransaction:d,updateTransaction:s}=B(),{categories:T,loading:z}=O(),[o,x]=a.useState("expense"),[k,u]=a.useState(""),[m,b]=a.useState(""),[p,i]=a.useState(""),[j,g]=a.useState(new Date().toISOString().split("T")[0]),[v,h]=a.useState(""),[E,N]=a.useState(!1),l=!!r;a.useEffect(()=>{r?(x(r.type),u(r.amount.toString()),b(r.description),i(r.category_id.toString()),g(r.transaction_date),h(r.notes||"")):(x("expense"),u(""),b(""),i(""),g(new Date().toISOString().split("T")[0]),h(""))},[r]),a.useEffect(()=>{l||i("")},[o,l]);const D=async t=>{t.preventDefault();const y=parseFloat(k);if(isNaN(y)||y<=0){f.error("Please enter a valid, positive amount.");return}if(!m){f.error("Please enter a description.");return}if(!p){f.error("Please select a category.");return}N(!0);const S={amount:y,description:m,category_id:p,transaction_date:j,type:o,notes:v};l&&r?await s(r.id,S):await d(S),N(!1),n()},w=T.filter(t=>t.type===o);return e.jsx(A,{children:c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center",onClick:n,children:e.jsxs(C.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",stiffness:400,damping:40},className:"w-full max-w-lg bg-light-primary dark:bg-dark-secondary rounded-t-2xl max-h-[85vh] flex flex-col pb-20",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-light-border dark:border-dark-border flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:l?"Edit Transaction":"Add Transaction"}),e.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-light-secondary dark:hover:bg-dark-primary",children:e.jsx(I,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})})]}),e.jsxs("form",{onSubmit:D,className:"flex-grow flex flex-col p-4 sm:p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx(R,{option1:"Expense",option2:"Income",selected:o,setSelected:x})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-2 text-center",children:"Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:`absolute left-4 top-1/2 transform -translate-y-1/2 text-2xl font-bold ${o==="expense"?"text-red-500":"text-green-500"}`,children:"â‚¹"}),e.jsx("input",{type:"number",value:k,onChange:t=>u(t.target.value),placeholder:"0.00",className:`
                                            w-full pl-12 pr-4 py-4 text-3xl font-bold text-center bg-light-secondary dark:bg-dark-secondary
                                            rounded-xl border-2 border-transparent focus:border-brand-green focus:outline-none
                                            text-light-text dark:text-dark-text
                                            placeholder:text-light-text-secondary/50 dark:placeholder:text-dark-text-secondary/50
                                        `,min:"0",step:"0.01",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-2",children:"Description"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:18}),e.jsx("input",{type:"text",placeholder:"Enter description",value:m,onChange:t=>b(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-2",children:"Category"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10",size:18}),e.jsxs("select",{value:p,onChange:t=>i(t.target.value),className:"w-full pl-10 pr-10 py-3 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none appearance-none",required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Select a category"}),z?e.jsx("option",{disabled:!0,children:"Loading categories..."}):w.length>0?w.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id)):e.jsxs("option",{disabled:!0,children:["No ",o," categories available"]})]}),e.jsx(_,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none",size:18})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-2",children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10",size:18}),e.jsx("input",{type:"date",value:j,onChange:t=>g(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none text-light-text dark:text-dark-text",required:!0,style:{colorScheme:"light"}})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-2",children:["Notes ",e.jsx("span",{className:"text-xs text-light-text-secondary dark:text-dark-text-secondary",children:"(optional)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 text-gray-500",size:18}),e.jsx("textarea",{placeholder:"Add any additional notes",value:v,onChange:t=>h(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none resize-none",rows:3})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-light-border dark:border-dark-border",children:e.jsx($,{type:"submit",isLoading:E,children:l?"Update Transaction":"Save Transaction"})})]})]})})})};export{M as default};
