import{r as d}from"./vendor-UbVtIYU6.js";import{u as m,q as u,w as y,c as n,o as E,d as s,g as b,e as D,i as F,f,j as S,k as q}from"./index-BUU1lA4v.js";import{z as o}from"./ui-CqB_xnuP.js";const I=()=>{const{user:a}=m(),[C,g]=d.useState([]),[h,c]=d.useState(!0);d.useEffect(()=>{if(!a){g([]),c(!1);return}c(!0);const e=u(n(s,"categories"),y("user_id","==",a.uid)),t=E(e,r=>{const i=r.docs.map(l=>{const w=l.data();return{id:l.id,...w}});g(i),c(!1)},r=>{console.error("Error fetching categories:",r),o.error("Failed to load categories"),c(!1)});return()=>t()},[a]);const p=d.useCallback(async()=>{},[]);return{categories:C,loading:h,addCategory:async e=>{if(a)try{await q(n(s,"categories"),{...e,user_id:a.uid,created_at:new Date().toISOString()}),o.success("Category added!")}catch(t){console.error("Error adding category:",t),o.error("Failed to add category")}},updateCategory:async(e,t)=>{try{const r=f(s,"categories",e);await S(r,t),o.success("Category updated!")}catch(r){console.error("Error updating category:",r),o.error("Failed to update category")}},deleteCategory:async e=>{try{await F(f(s,"categories",e)),o.success("Category deleted!")}catch(t){console.error("Error deleting category:",t),o.error("Failed to delete category")}},deleteAllCategories:async()=>{if(a)try{const e=u(n(s,"categories"),y("user_id","==",a.uid)),t=await b(e),r=D(s);t.docs.forEach(i=>{r.delete(i.ref)}),await r.commit(),o.success("All categories deleted!")}catch(e){console.error("Error deleting all categories:",e),o.error("Failed to delete all categories")}},refetch:p}};export{I as u};
