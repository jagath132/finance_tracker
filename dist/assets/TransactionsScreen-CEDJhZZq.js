import{j as e,h as f,m as h,H as v,q as w,r as z,X as C,C as T,o as j,I,k as y,J as D,n as b,K as _,D as L,p as A,d as P,a as S,N as F}from"./ui-Dy4X14_K.js";import{h as g,f as M,L as $}from"./vendor-gOpYt1fm.js";import{T as E}from"./TransactionListItem-ChvY6lyL.js";import{u as O}from"./useTransactions-9cdBbzWI.js";import{u as U}from"./useCategories-Cytt2SIa.js";import{a as q}from"./index-CbbJHnKT.js";import"./ConfirmationModal-DmTpPKXL.js";import"./Button-BdbUWFle.js";import"./supabase-RyWy78zx.js";const H=({isOpen:l,onClose:a,transaction:s,category:d,onEdit:c,onDelete:o})=>{if(!s)return null;const m=()=>{window.print()};return e.jsx(f,{children:l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center print:hidden",onClick:a,children:e.jsxs(h.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",stiffness:400,damping:40},className:"w-full max-w-lg bg-light-primary dark:bg-dark-secondary rounded-t-2xl max-h-[85vh] flex flex-col pb-20 print:max-w-none print:w-full print:max-h-none print:bg-white print:shadow-none print:rounded-none print:m-0 print:p-5",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-light-border dark:border-dark-border flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Invoice"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:m,className:"p-2 rounded-full hover:bg-light-secondary dark:hover:bg-dark-primary transition-colors",title:"Print/Download Invoice",children:e.jsx(v,{size:20,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),c&&e.jsx("button",{onClick:c,className:"p-2 rounded-full hover:bg-light-secondary dark:hover:bg-dark-primary transition-colors",children:e.jsx(w,{size:20,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),o&&e.jsx("button",{onClick:o,className:"p-2 rounded-full hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:e.jsx(z,{size:20,className:"text-red-500"})}),e.jsx("button",{onClick:a,className:"p-2 rounded-full hover:bg-light-secondary dark:hover:bg-dark-primary transition-colors",children:e.jsx(C,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})})]})]}),e.jsxs("div",{className:"flex-grow p-4 sm:p-6 overflow-y-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"bg-dark-secondary p-4 rounded-full inline-block mb-4",children:e.jsx(T,{className:"text-brand-green",size:48,strokeWidth:1.5})}),e.jsx("h2",{className:"text-2xl font-bold text-light-text dark:text-dark-text",children:"Cointrail"}),e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Personal Finance Tracker"})]}),e.jsxs("div",{className:"bg-light-secondary dark:bg-dark-secondary rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Invoice #"}),e.jsx("span",{className:"font-mono text-sm",children:s.id.slice(-8)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Date"}),e.jsx("span",{children:new Date(s.transaction_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"space-y-4 bg-light-secondary dark:bg-dark-secondary rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"text-gray-500 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Description"}),e.jsx("p",{className:"font-semibold",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"text-gray-500 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Amount"}),e.jsxs("p",{className:`font-bold text-xl ${s.type==="income"?"text-brand-green":"text-brand-red"}`,children:[s.type==="income"?"+":"-","â‚¹",new Intl.NumberFormat("en-IN").format(s.amount)]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"text-gray-500 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Category"}),e.jsxs("div",{className:"flex items-center",children:[d?.icon&&g.createElement(D[d.icon.charAt(0).toUpperCase()+d.icon.slice(1)]||y,{size:16,className:"mr-2"}),e.jsx("p",{children:d?.name||"Uncategorized"})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"text-gray-500 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Type"}),e.jsx("p",{className:"capitalize",children:s.type})]})]}),s.notes&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(j,{className:"text-gray-500 mr-3 mt-1",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Notes"}),e.jsx("p",{children:s.notes})]})]}),s.attachment_url&&e.jsxs("div",{className:"flex items-start",children:[/\.(jpg|jpeg|png|gif|webp)$/i.test(s.attachment_url)?e.jsx(_,{className:"text-gray-500 mr-3 mt-1",size:20}):e.jsx(L,{className:"text-gray-500 mr-3 mt-1",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Attachment"}),/\.(jpg|jpeg|png|gif|webp)$/i.test(s.attachment_url)?e.jsx("img",{src:s.attachment_url,alt:"Attachment",className:"max-w-full h-auto rounded mt-2",loading:"lazy"}):e.jsx("a",{href:s.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"text-brand-green underline",children:"Download File"})]})]})]}),e.jsx("div",{className:"text-center mt-8 pt-4 border-t border-light-border dark:border-dark-border",children:e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Thank you for using Cointrail!"})})]})]})})})},V=()=>{const l=M(),{transactions:a,loading:s,deleteTransaction:d}=O(),{categories:c,loading:o}=U(),{openModal:m}=q(),[i,x]=g.useState(null),p=t=>c.find(r=>r.id===t)||null,u=()=>{window.scrollTo({top:0,behavior:"smooth"})},k=s||o,N=g.useMemo(()=>{const t={};for(const r of a){const n=new Date(r.transaction_date).toDateString();t[n]||(t[n]=[]),t[n].push(r)}return t},[a]);return e.jsxs("div",{className:"min-h-screen p-4 sm:p-6",children:[e.jsxs("header",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:()=>l("/dashboard"),className:"p-2 rounded-full bg-light-secondary dark:bg-dark-secondary",children:e.jsx(A,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Transactions"}),e.jsx("button",{onClick:()=>l("/search"),className:"p-2 rounded-full bg-light-secondary dark:bg-dark-secondary",children:e.jsx(P,{size:20,className:"text-light-text-secondary dark:text-dark-text-secondary"})})]}),k?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(S,{className:"animate-spin text-brand-green",size:32})}):a.length>0?e.jsx(h.div,{className:"space-y-4 sm:space-y-6",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05,delayChildren:.1}}},children:Object.entries(N).map(([t,r])=>e.jsxs(h.div,{variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},transition:{duration:.2,ease:"easeOut"},children:[e.jsxs("div",{className:"flex items-center mb-2 sm:mb-3",children:[e.jsx(b,{size:16,className:"text-light-text-secondary dark:text-dark-text-secondary mr-2"}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-light-text dark:text-dark-text",children:new Date(t).toLocaleDateString("en-IN",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]}),e.jsx("div",{className:"space-y-2",children:r.map(n=>e.jsx(E,{transaction:n,category:p(n.category_id),onDelete:()=>d(n.id),onEdit:()=>x(n.id),onClick:()=>l(`/transactions/${n.id}`)},n.id))})]},t))}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary mb-4",children:"You have no transactions."}),e.jsx($,{to:"/add-transaction",className:"bg-brand-green text-white font-bold py-3 px-6 rounded-xl text-lg hover:bg-green-600 transition-colors",children:"Add Transaction"})]}),e.jsx("button",{onClick:u,className:"fixed bottom-20 right-4 p-3 rounded-full bg-brand-green hover:bg-green-600 text-white shadow-lg transition-colors z-50",children:e.jsx(F,{size:24})}),e.jsx(H,{isOpen:!!i,onClose:()=>x(null),transaction:a.find(t=>t.id===i)||null,category:p(a.find(t=>t.id===i)?.category_id||""),onEdit:()=>{const t=a.find(r=>r.id===i);t&&m("editTransaction",t),x(null)},onDelete:()=>{const t=a.find(r=>r.id===i);t&&d(t.id),x(null)}},i)]})};export{V as default};
