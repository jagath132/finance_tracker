import{j as e,p as S,e as v,X as k,a as C}from"./ui-9V2nKd88.js";import{r as t,f as w}from"./vendor-BLIq4JPC.js";import{u as T,s as g}from"./index-B5lVPReX.js";import{T as z}from"./TransactionListItem-Bc1y0aYW.js";import{u as E}from"./useCategories-ITDpBBlg.js";import"./supabase-GK0Ohaqy.js";import"./ConfirmationModal-BQzURq6n.js";import"./Button-fgWSp_I2.js";function L(a,r){const[d,o]=t.useState(a);return t.useEffect(()=>{const i=setTimeout(()=>{o(a)},r);return()=>{clearTimeout(i)}},[a,r]),d}const F=()=>{const a=w(),{user:r}=T(),{categories:d}=E(),[o,i]=t.useState(""),[u,l]=t.useState([]),[x,p]=t.useState(!1),[y,h]=t.useState(!1),m=L(o,300),f=t.useCallback(async s=>{if(!r||s.trim()===""){l([]),h(s.trim()!=="");return}p(!0),h(!0);const{data:n,error:c}=await g.from("transactions").select("*").eq("user_id",r.id).ilike("description",`%${s}%`).order("transaction_date",{ascending:!1});c?(console.error("Search error:",c),l([])):l(n||[]),p(!1)},[r]);t.useEffect(()=>{f(m)},[m,f]);const j=s=>{var n;return((n=d.find(c=>c.id===s))==null?void 0:n.name)||"Uncategorized"},b=async s=>{const{error:n}=await g.from("transactions").delete().eq("id",s);n||l(c=>c.filter(N=>N.id!==s))};return e.jsxs("div",{className:"min-h-screen bg-dark-primary text-white p-4 sm:p-6",children:[e.jsxs("header",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>a(-1),className:"p-2 rounded-full hover:bg-dark-secondary",children:e.jsx(S,{size:24,className:"text-gray-400"})}),e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(v,{size:20,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search by description...",value:o,onChange:s=>i(s.target.value),className:"w-full bg-dark-secondary border border-gray-700 rounded-lg p-3 pl-10 pr-10 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brand-green",autoFocus:!0}),o&&e.jsx("button",{onClick:()=>i(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:e.jsx(k,{size:20})})]})]}),e.jsx("main",{children:x?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(C,{className:"animate-spin text-brand-green",size:32})}):y?u.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:[u.length," result(s) found"]}),u.map(s=>e.jsx(z,{transaction:s,categoryName:j(s.category_id),onDelete:()=>b(s.id),onEdit:()=>a(`/transactions/${s.id}`),onClick:()=>a(`/transactions/${s.id}`)},s.id))]}):e.jsx("div",{className:"text-center py-20",children:e.jsxs("p",{className:"text-gray-400",children:['No transactions found for "',m,'".']})}):e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-gray-400",children:"Start typing to search your transactions."})})})]})};export{F as default};
