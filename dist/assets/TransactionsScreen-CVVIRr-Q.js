import{j as e,h as N,m as k,Y as A,Z as P,q as F,r as R,X as L,R as M,o as I,l as T,u as z,_ as U,k as O,$ as q,w as Y,a0 as G,p as X,d as Z,a as B,n as H,a1 as J}from"./ui-_IaUIWm1.js";import{r as D,h as p,e as K,L as Q}from"./vendor-CeoOk9QE.js";import{T as V}from"./TransactionListItem-C6MIkaLP.js";import{u as W}from"./useTransactions-BwkPODxv.js";import{u as ee}from"./useCategories-nji49Pe3.js";import{a as te}from"./index-Ita0Wmma.js";import"./ConfirmationModal-Ldo8QTtN.js";import"./Button-BYbGGxhE.js";const re=({isOpen:v,onClose:i,transaction:r,category:h,onEdit:y,onDelete:w})=>{const[x,m]=D.useState({details:!0,notes:!1,attachments:!1}),[n,d]=D.useState(!1),[j,o]=D.useState(r);if(!r)return null;const f=()=>{window.print()},l=c=>{m(b=>({...b,[c]:!b[c]}))},C=()=>{d(!1)},g=()=>{o(r),d(!1)};return e.jsx(N,{children:v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center print:hidden p-4",onClick:i,children:e.jsxs(k.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-2xl bg-light-primary dark:bg-dark-primary rounded-2xl shadow-2xl max-h-[90vh] flex flex-col overflow-hidden print:max-w-none print:w-full print:max-h-none print:bg-white print:shadow-none print:rounded-none print:m-0 print:p-6",onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-light-border dark:border-dark-border bg-gradient-to-r from-brand-green/5 to-brand-green/10 dark:from-brand-green/10 dark:to-brand-green/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white dark:bg-dark-secondary rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("img",{src:"/favicon.svg",alt:"Cointrail Logo",className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-light-text dark:text-dark-text",children:"Cointrail"}),e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Professional Finance Tracker"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-dark-secondary/50 transition-colors",title:"Print Invoice",children:e.jsx(A,{size:20,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),y&&e.jsx("button",{onClick:()=>d(!n),className:`p-2 rounded-lg transition-colors ${n?"bg-brand-green text-white":"hover:bg-white/50 dark:hover:bg-dark-secondary/50 text-light-text-secondary dark:text-dark-text-secondary"}`,title:n?"Save Changes":"Edit Transaction",children:n?e.jsx(P,{size:20}):e.jsx(F,{size:20})}),w&&e.jsx("button",{onClick:w,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete Transaction",children:e.jsx(R,{size:20,className:"text-red-500"})}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-white/50 dark:hover:bg-dark-secondary/50 transition-colors",children:e.jsx(L,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})})]})]})}),e.jsxs("div",{className:"flex-grow overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(M,{className:"text-brand-green",size:24}),e.jsx("h2",{className:"text-xl font-semibold text-light-text dark:text-dark-text",children:"Transaction Invoice"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary",children:"Invoice #"}),e.jsx("p",{className:"font-mono text-lg font-semibold",children:r.id.slice(-8)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Date"}),e.jsx("p",{className:"font-medium",children:new Date(r.transaction_date).toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary",children:"Time"}),e.jsx("p",{className:"font-medium",children:new Date(r.transaction_date).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})})]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg cursor-pointer hover:bg-light-primary dark:hover:bg-dark-primary transition-colors",onClick:()=>l("details"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"text-brand-green",size:20}),e.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text",children:"Transaction Details"})]}),x.details?e.jsx(T,{size:20}):e.jsx(z,{size:20})]}),e.jsx(N,{children:x.details&&e.jsx(k.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Description"}),n?e.jsx("input",{type:"text",value:j?.description||"",onChange:c=>o(b=>b?{...b,description:c.target.value}:null),className:"w-full p-3 border border-light-border dark:border-dark-border rounded-lg bg-light-primary dark:bg-dark-primary focus:ring-2 focus:ring-brand-green focus:border-transparent"}):e.jsx("p",{className:"p-3 bg-light-primary dark:bg-dark-primary rounded-lg font-medium",children:r.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Amount"}),e.jsxs("div",{className:`p-3 rounded-lg font-bold text-xl ${r.type==="income"?"bg-green-50 dark:bg-green-900/20 text-brand-green":"bg-red-50 dark:bg-red-900/20 text-brand-red"}`,children:[r.type==="income"?"+":"-","â‚¹",new Intl.NumberFormat("en-IN").format(r.amount)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Category"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-light-primary dark:bg-dark-primary rounded-lg",children:[h?.icon&&p.createElement(U[h.icon.charAt(0).toUpperCase()+h.icon.slice(1)]||O,{size:20,className:"text-brand-green"}),e.jsx("span",{className:"font-medium",children:h?.name||"Uncategorized"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary",children:"Type"}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.type==="income"?"bg-green-100 dark:bg-green-900/30 text-brand-green":"bg-red-100 dark:bg-red-900/30 text-brand-red"}`,children:e.jsx("span",{className:"capitalize",children:r.type})})]})]})]})})})]}),r.notes&&e.jsxs("div",{className:"p-6 border-t border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg cursor-pointer hover:bg-light-primary dark:hover:bg-dark-primary transition-colors",onClick:()=>l("notes"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"text-brand-green",size:20}),e.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text",children:"Notes"})]}),x.notes?e.jsx(T,{size:20}):e.jsx(z,{size:20})]}),e.jsx(N,{children:x.notes&&e.jsx(k.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"mt-4 p-4 bg-light-primary dark:bg-dark-primary rounded-lg",children:e.jsx("p",{className:"text-light-text dark:text-dark-text whitespace-pre-wrap",children:r.notes})})})})]}),r.attachment_url&&e.jsxs("div",{className:"p-6 border-t border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg cursor-pointer hover:bg-light-primary dark:hover:bg-dark-primary transition-colors",onClick:()=>l("attachments"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"text-brand-green",size:20}),e.jsx("h3",{className:"font-semibold text-light-text dark:text-dark-text",children:"Attachments"})]}),x.attachments?e.jsx(T,{size:20}):e.jsx(z,{size:20})]}),e.jsx(N,{children:x.attachments&&e.jsx(k.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"mt-4 p-4 bg-light-primary dark:bg-dark-primary rounded-lg",children:/\.(jpg|jpeg|png|gif|webp)$/i.test(r.attachment_url)?e.jsx("img",{src:r.attachment_url,alt:"Attachment",className:"max-w-full h-auto rounded-lg shadow-md",loading:"lazy"}):e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-light-secondary dark:bg-dark-secondary rounded-lg",children:[e.jsx(Y,{className:"text-brand-green",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-light-text dark:text-dark-text",children:"Download File"}),e.jsx("a",{href:r.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"text-brand-green hover:underline text-sm",children:"Click to download"})]})]})})})})]}),n&&e.jsx("div",{className:"p-6 border-t border-light-border dark:border-dark-border bg-light-secondary dark:bg-dark-secondary",children:e.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 text-light-text-secondary dark:text-dark-text-secondary hover:bg-light-primary dark:hover:bg-dark-primary rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:C,className:"px-4 py-2 bg-brand-green text-white rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-2",children:[e.jsx(G,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})}),e.jsx("div",{className:"p-6 border-t border-light-border dark:border-dark-border bg-gradient-to-r from-brand-green/5 to-brand-green/10 dark:from-brand-green/10 dark:to-brand-green/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary mb-2",children:"Thank you for using Cointrail!"}),e.jsxs("p",{className:"text-xs text-light-text-secondary dark:text-dark-text-secondary",children:["Generated on ",new Date().toLocaleDateString("en-IN")]})]})})]})]})})})},xe=()=>{const v=K(),{transactions:i,loading:r,deleteTransaction:h}=W(),{categories:y,loading:w}=ee(),{openModal:x}=te(),[m,n]=p.useState(null),[d,j]=p.useState(""),[o,f]=p.useState("all"),[l,C]=p.useState(""),[g,c]=p.useState(""),b=t=>y.find(a=>a.id===t)?.name||"Uncategorized",S=t=>y.find(a=>a.id===t)||null,_=()=>{window.scrollTo({top:0,behavior:"smooth"})},E=r||w,$=p.useMemo(()=>{const t=i.filter(s=>{if(o!=="all"&&s.type!==o)return!1;const u=new Date(s.transaction_date);return l&&u<new Date(l)||g&&u>new Date(g+"T23:59:59")?!1:s.description.toLowerCase().includes(d.toLowerCase())||b(s.category_id).toLowerCase().includes(d.toLowerCase())}),a={};for(const s of t){const u=new Date(s.transaction_date).toDateString();a[u]||(a[u]=[]),a[u].push(s)}return a},[i,d,y,o,l,g]);return e.jsxs("div",{className:"min-h-screen p-4 sm:p-6 lg:p-8 pb-20",children:[e.jsxs("header",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>v("/dashboard"),className:"p-2 rounded-full bg-light-secondary dark:bg-dark-secondary",children:e.jsx(X,{size:24,className:"text-light-text-secondary dark:text-dark-text-secondary"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Transactions"}),e.jsx("div",{className:"w-8"})," "]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:18}),e.jsx("input",{type:"text",placeholder:"Search transactions...",value:d,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-10 py-3 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none"}),d&&e.jsx("button",{onClick:()=>j(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(L,{size:18})})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:l,onChange:t=>C(t.target.value),className:"w-full px-3 py-2 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none text-sm"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-light-text-secondary dark:text-dark-text-secondary mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:g,onChange:t=>c(t.target.value),className:"w-full px-3 py-2 bg-light-secondary dark:bg-dark-secondary rounded-lg border border-light-border dark:border-dark-border focus:border-brand-green focus:outline-none text-sm"})]}),(l||g)&&e.jsx("button",{onClick:()=>{C(""),c("")},className:"self-end px-3 py-2 text-red-400 hover:text-red-300 text-sm font-medium",children:"Clear"})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{onClick:()=>f("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o==="all"?"bg-brand-green text-white":"bg-light-secondary dark:bg-dark-secondary text-light-text-secondary dark:text-dark-text-secondary hover:bg-light-border dark:hover:bg-dark-border"}`,children:"All"}),e.jsx("button",{onClick:()=>f("income"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o==="income"?"bg-green-500 text-white":"bg-light-secondary dark:bg-dark-secondary text-light-text-secondary dark:text-dark-text-secondary hover:bg-light-border dark:hover:bg-dark-border"}`,children:"Income"}),e.jsx("button",{onClick:()=>f("expense"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o==="expense"?"bg-red-500 text-white":"bg-light-secondary dark:bg-dark-secondary text-light-text-secondary dark:text-dark-text-secondary hover:bg-light-border dark:hover:bg-dark-border"}`,children:"Expenses"})]})]}),E?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(B,{className:"animate-spin text-brand-green",size:32})}):i.length>0?e.jsx(N,{children:e.jsx(k.div,{className:"space-y-4 sm:space-y-6",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05,delayChildren:.1}}},children:Object.entries($).map(([t,a])=>e.jsxs(k.div,{layout:!0,variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},exit:{opacity:0,y:-10},transition:{duration:.2,ease:"easeOut"},children:[e.jsxs("div",{className:"flex items-center mb-2 sm:mb-3",children:[e.jsx(H,{size:16,className:"text-light-text-secondary dark:text-dark-text-secondary mr-2"}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-light-text dark:text-dark-text",children:new Date(t).toLocaleDateString("en-IN",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]}),e.jsx("div",{className:"space-y-2",children:a.map(s=>e.jsx(V,{transaction:s,category:S(s.category_id),onDelete:()=>h(s.id),onEdit:()=>n(s.id),onClick:()=>v(`/transactions/${s.id}`)},s.id))})]},t))})}):d?e.jsxs("div",{className:"text-center py-20",children:[e.jsxs("p",{className:"text-light-text-secondary dark:text-dark-text-secondary mb-4",children:['No transactions found for "',d,'"']}),e.jsx("button",{onClick:()=>j(""),className:"text-brand-green hover:underline",children:"Clear search"})]}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-light-text-secondary dark:text-dark-text-secondary mb-4",children:"You have no transactions."}),e.jsx(Q,{to:"/add-transaction",className:"bg-brand-green text-white font-bold py-3 px-6 rounded-xl text-lg hover:bg-green-600 transition-colors",children:"Add Transaction"})]}),e.jsx("button",{onClick:_,className:"fixed bottom-20 right-4 p-3 rounded-full bg-brand-green hover:bg-green-600 text-white shadow-lg transition-colors z-50",children:e.jsx(J,{size:24})}),e.jsx(re,{isOpen:!!m,onClose:()=>n(null),transaction:i.find(t=>t.id===m)||null,category:S(i.find(t=>t.id===m)?.category_id||""),onEdit:()=>{const t=i.find(a=>a.id===m);t&&x("editTransaction",t),n(null)},onDelete:()=>{const t=i.find(a=>a.id===m);t&&h(t.id),n(null)}},m)]})};export{xe as default};
